Map (num_proc=8): 100%|███████████| 1000/1000 [00:00<00:00, 8177.96 examples/s]
Casting the dataset: 100%|██████| 1000/1000 [00:00<00:00, 155494.33 examples/s]
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at Snowflake/snowflake-arctic-embed-l and are newly initialized: ['classifier.bias', 'classifier.weight', 'pooler.dense.bias', 'pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map: 100%|███████████████████████████| 900/900 [00:01<00:00, 883.67 examples/s]

Map: 100%|███████████████████████████| 100/100 [00:00<00:00, 839.07 examples/s]
[34m[1mwandb[39m[22m: [33mWARNING[39m The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
  0%|                                                   | 0/50 [00:00<?, ?it/s]/opt/conda/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  0%|                                                    | 0/1 [00:00<?, ?it/s]
Validation Report:
              precision    recall  f1-score   support
           0       0.00      0.00      0.00        10
           1       0.43      0.98      0.60        42
           2       0.20      0.04      0.07        23
           3       0.00      0.00      0.00        20
           4       0.00      0.00      0.00         5
    accuracy                           0.42       100
   macro avg       0.13      0.20      0.13       100
weighted avg       0.23      0.42      0.27       100
Confusion Matrix:
[[ 0  8  2  0  0]
 [ 0 41  1  0  0]
 [ 0 22  1  0  0]
 [ 0 19  1  0  0]
 [ 0  5  0  0  0]]
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result)) ?it/s]
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
  0%|                                                   | 0/50 [00:09<?, ?it/s]/opt/conda/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '






























 98%|█████████████████████████████████████████▏| 49/50 [01:11<00:01,  1.27s/it]

100%|██████████████████████████████████████████| 50/50 [01:12<00:00,  1.26s/it]

100%|██████████████████████████████████████████| 50/50 [01:15<00:00,  1.51s/it]
/opt/conda/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
  0%|                                                    | 0/1 [00:00<?, ?it/s]
Validation Report:
              precision    recall  f1-score   support
           0       0.00      0.00      0.00        10
           1       0.57      0.10      0.16        42
           2       0.31      0.65      0.42        23
           3       0.20      0.20      0.20        20
           4       0.14      0.60      0.23         5
           5       0.00      0.00      0.00         0
    accuracy                           0.26       100
   macro avg       0.20      0.26      0.17       100
weighted avg       0.36      0.26      0.22       100
Confusion Matrix:
[[ 0  3  7  0  0  0]
 [ 0  4 27 11  0  0]
 [ 0  0 15  4  4  0]
 [ 0  0  0  4 14  2]
 [ 0  0  0  1  3  1]
  0%|                                                    | 0/1 [00:00<?, ?it/s]/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
100%|████████████████████████████████████████████| 1/1 [00:01<00:00,  1.95s/it]
Validation Report:
              precision    recall  f1-score   support
           0       0.00      0.00      0.00        10
           1       0.57      0.10      0.16        42
           2       0.31      0.65      0.42        23
           3       0.20      0.20      0.20        20
           4       0.14      0.60      0.23         5
           5       0.00      0.00      0.00         0
    accuracy                           0.26       100
   macro avg       0.20      0.26      0.17       100
weighted avg       0.36      0.26      0.22       100
Confusion Matrix:
[[ 0  3  7  0  0  0]
 [ 0  4 27 11  0  0]
 [ 0  0 15  4  4  0]
 [ 0  0  0  4 14  2]
 [ 0  0  0  1  3  1]
 [ 0  0  0  0  0  0]]
Confusion Matrix after training:
[[ 0  3  7  0  0  0]
 [ 0  4 27 11  0  0]
 [ 0  0 15  4  4  0]
 [ 0  0  0  4 14  2]
 [ 0  0  0  1  3  1]
 [ 0  0  0  0  0  0]]
Metrics after training:
 {'precision': 0.20340136054421767, 'recall': 0.25790200138026226, 'f1_macro': 0.16845020059305774, 'accuracy': 0.26}
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
/opt/conda/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1531: UndefinedMetricWarning: Recall is ill-defined and being set to 0.0 in labels with no true samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))